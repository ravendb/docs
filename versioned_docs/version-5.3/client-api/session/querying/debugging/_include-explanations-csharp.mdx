import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<Admonition type="note" title="">

* When making a query, each document in the query results is assigned a __score__.  
  This score determines the order by which the documents come back in the results when requesting   
  to [order by score](../../../../client-api/session/querying/sort-query-results.mdx#order-by-score).

* Each document in the results includes this score under the `@index-score` property in its metadata.

* __To get the score details__ and see how it was calculated,  
  you can use `IncludeExplanations` when querying with a [DocumentQuery](../../../../client-api/session/querying/document-query/what-is-document-query.mdx). 

* In this page:
    * [Include explanations in a query](../../../../client-api/session/querying/debugging/include-explanations.mdx#include-explanations-in-a-query)  
    * [View explanations](../../../../client-api/session/querying/debugging/include-explanations.mdx#view-explanations)  
    * [Syntax](../../../../client-api/session/querying/debugging/include-explanations.mdx#syntax)  
</Admonition>
## Include explanations in a query

<Tabs groupId='languageSyntax'>
<TabItem value="DocumentQuery" label="DocumentQuery">
<CodeBlock language="csharp">
{`// Query with \`DocumentQuery\`
var results = session.Advanced.DocumentQuery<Product>()
    
     // Call IncludeExplanations, provide an out param for the explanations results
    .IncludeExplanations(out Explanations explanations)
     // Define query criteria
     // i.e. search for docs containing Syrup -or- Lager in their Name field
    .Search(x => x.Name, "Syrup Lager")
     // Execute the query
    .ToList();

// Get the score details for a specific document from the results
// Call GetExplanations on the resulting Explanations object
string[] scoreDetails = explanations.GetExplanations(results[0].Id);
`}
</CodeBlock>
</TabItem>
<TabItem value="DocumentQuery_async" label="DocumentQuery_async">
<CodeBlock language="csharp">
{`// Query with \`AsyncDocumentQuery\`
var results = await asyncSession.Advanced.AsyncDocumentQuery<Product>()
    
     // Call IncludeExplanations, provide an out param for the explanations results
    .IncludeExplanations(out Explanations explanations)
     // Define query criteria
     // i.e. search for docs containing Syrup -or- Lager in their Name field
    .Search(x => x.Name, "Syrup Lager")
     // Execute the query
    .ToListAsync();

// Get the score details for a specific document from the results
// Call GetExplanations on the resulting Explanations object
string[] scoreDetails = explanations.GetExplanations(results[0].Id);
`}
</CodeBlock>
</TabItem>
<TabItem value="RQL" label="RQL">
<CodeBlock language="sql">
{`from "Products"
where search(Name, "Syrup") or search(Name, "Lager")
include explanations()
`}
</CodeBlock>
</TabItem>
</Tabs>



## View explanations

* The detailed explanations can be viewed from the __Query view__ in the Studio.  

* Running a query with `include explanations()` will show an additional __Explanations Tab__.

![Figure 1. Explanations in the Studio](./assets/include-explanations-1.png)

* Sample score details:

![Figure 2. View explanations](./assets/include-explanations-2.png)



## Syntax

<TabItem value="syntax" label="syntax">
<CodeBlock language="csharp">
{`IDocumentQuery<T> IncludeExplanations(out Explanations explanations);
`}
</CodeBlock>
</TabItem>


| Parameter        | Type           | Description                                                      |
|------------------|----------------|------------------------------------------------------------------|
| **explanations** | `Explanations` | An _out_ param that will be filled with the explanations results |

| `Explanations`                           | Description |
|------------------------------------------|-------------|
| `string[] GetExplanations(string docId)` | <ul><li>Pass the resulting document ID for which to get score details.</li><li>Returns a list with all explanations.</li></ul> |
