import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

Commands can be deferred till `saveChanges` is called by using `defer` method in `advanced` session operations.  
All of the operations will update teh session state appropriately after `saveChanges` is called.

Types of commands that can be deferred:

- [PutCommandData](../../../../glossary/put-command-data.mdx)
- [DeleteCommandData](../../../../glossary/delete-command-data.mdx)
- DeletePrefixedCommandData
- [PatchCommandData](../../../../glossary/patch-command-data.mdx)
- PutAttachmentCommandData
- DeleteAttachmentCommandData
- [CopyAttachmentCommandData](../../../../glossary/copy-attachment-command-data.mdx)
- [MoveAttachmentCommandData](../../../../glossary/move-attachment-command-data.mdx)
- [CountersBatchCommandData](../../../../glossary/counters-batch-command-data.mdx)

## Syntax

<TabItem value="defer_1" label="defer_1">
<CodeBlock language="java">
{`void defer(ICommandData command, ICommandData... commands);

void defer(ICommandData[] commands);
`}
</CodeBlock>
</TabItem>

| Parameter        | Description                                              |
|------------------|----------------------------------------------------------|
| `ICommandData`   | Command to be executed.                                  |
| `ICommandData[]` | Array of commands implementing `ICommandData` interface. |

## Example

<TabItem value="defer_2" label="defer_2">
<CodeBlock language="java">
{`Map<String, Object> value1 = new HashMap<>();
value1.put("Name", "My Product");
value1.put("Supplier", "suppliers/999-A");
value1.put("@metadata", Collections.singletonMap("@collection", "Users"));

PutCommandDataWithJson putCommand1 =
    new PutCommandDataWithJson("products/999-A",
        null,
        store.getConventions().getEntityMapper().valueToTree(value1));

HashMap<String, Object> value2 = new HashMap<>();
value2.put("Name", "My Product");
value2.put("Supplier", "suppliers/999-A");
value2.put("@metadata", Collections.singletonMap("@collection", "Suppliers"));

PutCommandDataWithJson putCommand2 =
    new PutCommandDataWithJson("suppliers/999-A",
        null,
        store.getConventions().getEntityMapper().valueToTree(value2));

DeleteCommandData command3 = new DeleteCommandData("products/1-A", null);

session.advanced().defer(putCommand1, putCommand2, command3);
`}
</CodeBlock>
</TabItem>


