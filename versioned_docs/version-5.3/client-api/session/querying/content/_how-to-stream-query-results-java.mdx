import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

RavenDB supports __streaming data__ from the server to the client.  
Streaming is useful when processing a large number of results.

The data streamed can be a result of a dynamic query, a static index query, or just filtered by a prefix.

To stream results, use the `stream` method from the `advanced` session operations.
## Streaming overview

* __Immediate processing__:  
  Neither the client nor the server holds the full response in memory.   
  Instead, as soon as the server has a single result, it sends it to the client.  
  Thus, your application can start processing results before the server sends them all.

* __No tracking__:  
  The stream results are Not tracked by the session.  
  Changes made to the resulting entities will not be sent to the server when _saveChanges_ is called.

* __A snapshot of the data__:  
  The stream results are a snapshot of the data at the time when the query is computed by the server.  
  Results that match the query after it was already processed are Not streamed to the client.

* __Query limitations:__:

    * A streaming query does not wait for indexing by design.  
      So calling [waitForNonStaleResults](../../../client-api/session/querying/how-to-customize-query.mdx#waitfornonstaleresults) is Not supported and will result in an exception.

    * Using [include](../../../client-api/session/loading-entities.mdx#load-with-includes) to load a related document to the session in a streaming query is Not supported.  



## Syntax

<TabItem value="stream_1" label="stream_1">
<CodeBlock language="java">
{`<T> CloseableIterator<StreamResult<T>> stream(IDocumentQuery<T> query);

<T> CloseableIterator<StreamResult<T>> stream(IDocumentQuery<T> query, Reference<StreamQueryStatistics> streamQueryStats);

<T> CloseableIterator<StreamResult<T>> stream(IRawDocumentQuery<T> query);

<T> CloseableIterator<StreamResult<T>> stream(IRawDocumentQuery<T> query, Reference<StreamQueryStatistics> streamQueryStats);
`}
</CodeBlock>
</TabItem>

| Parameters | | |
| ------------- | ------------- | ----- |
| **query** | [IDocumentQuery](../../../querying/overview.mdx#session-advanced-documentquery) or [IRawDocumentQuery](../../../querying/overview.mdx#session-advanced-rawquery) | Query to stream results for. |
| `Reference` **streamQueryStats** | StreamQueryStatistics | Information about performed query. |

| Return Value | |
| ------------- | ----- |
| CloseableIterator&lt;StreamResult&gt; | Iterator with entities. |

## Example I - Using Static Index

<TabItem value="stream_2" label="stream_2">
<CodeBlock language="java">
{`IDocumentQuery<Employee> query = session
    .query(Employee.class, Employees_ByFirstName.class)
    .whereEquals("FirstName", "Robert");

CloseableIterator<StreamResult<Employee>> results = session.advanced().stream(query);

while (results.hasNext()) \{
    StreamResult<Employee> employee = results.next();
\}
`}
</CodeBlock>
</TabItem>

## Example II - Dynamic Document Query

<TabItem value="stream_3" label="stream_3">
<CodeBlock language="java">
{`IDocumentQuery<Employee> query = session
    .advanced()
    .documentQuery(Employee.class)
    .whereEquals("FirstName", "Robert");

Reference<StreamQueryStatistics> streamQueryStatsRef = new Reference<>();
CloseableIterator<StreamResult<Employee>> results = session.advanced().stream(query, streamQueryStatsRef);

while (results.hasNext()) \{
    StreamResult<Employee> employee = results.next();
\}
`}
</CodeBlock>
</TabItem>

## Example III - Dynamic Raw Query

<TabItem value="stream_4" label="stream_4">
<CodeBlock language="java">
{`IRawDocumentQuery<Employee> query = session.advanced()
    .rawQuery(Employee.class, "from Employees where FirstName = 'Robert'");

CloseableIterator<StreamResult<Employee>> results = session.advanced().stream(query);

while (results.hasNext()) \{
    StreamResult<Employee> employee = results.next();
\}
`}
</CodeBlock>
</TabItem>


