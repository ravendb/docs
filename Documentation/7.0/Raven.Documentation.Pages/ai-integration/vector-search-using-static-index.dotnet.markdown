# Vector Search using a Static Index
---

{NOTE: }

* This article explains how to perform a **vector search** using a **static index**.  
  **Prior to this article**, it is recommended to get familiar with the [Vector search using a dynamic query](../ai-integration/vector-search-using-dynamic-query) article.

* A static index allows you to define a **vector index-field**, enabling you to execute vector searches
  while leveraging the advantages of RavenDB's [indexes](../indexes/what-are-indexes).

* The vector search feature is only supported by indexes that use the [Corax search engine](../indexes/search-engine/corax).

* In this page:
    * [Indexing a vector field - Overview](../ai-integration/vector-search-using-static-index#indexing-a-vector-field---overview)
       * [Parameters defined at index definition](../ai-integration/vector-search-using-static-index#parameters-defined-at-index-definition)
       * [Behavior during indexing](../ai-integration/vector-search-using-static-index#behavior-during-indexing)
       * [Parameters used at query time](../ai-integration/vector-search-using-static-index#parameters-used-at-query-time)
       * [Behavior when documents are deleted](../ai-integration/vector-search-using-static-index#vector-behavior-when-documents-are-deleted)
    * [Indexing vector data - TEXT](../ai-integration/vector-search-using-static-index#indexing-vector-data---text)
    * [Indexing vector data - NUMERICAL](../ai-integration/vector-search-using-static-index#indexing-vector-data---numerical)
    * [Indexing multiple field types](../ai-integration/vector-search-using-static-index#indexing-multiple-field-types)
    * [Define a vector field in the Studio](../ai-integration/vector-search-using-static-index#define-a-vector-field-in-the-studio)
    * [Syntax](../ai-integration/vector-search-using-static-index#syntax)

{NOTE/}

---

{PANEL: Indexing a vector field - Overview}

* To define a **vector index-field** in your static-index definition:  
  * From the Client API - use method `CreateVector()`, examples are provided later in this article.  
  * From the Studio - see [Define a vector field in the Studio](../ai-integration/vector-search-using-static-index#define-a-vector-field-in-the-studio).  

* The **source data types** that can be used for vector search is detailed in [Data types for vector search](../ai-integration/data-types-for-vector-search).

{CONTENT-FRAME: }

#### Parameters defined at index definition  
---

The following params can be defined for the vector index-field in the index definition:  

**Source embedding type** -   
RavenDB supports performing vector search on TEXTUAL values or NUMERICAL arrays.  
This param specifies the embedding format of the source data to be indexed.  
Options include `Text`, `Single`, `Int8`, or `Binary`.  

**Destination embedding type** -   
Specify the quantization format for the embeddings that will be generated.  
Read more about quantization in [Quantization options](../ai-integration/vector-search-using-dynamic-query#quantization-options).

**Dimensions** -   
For numerical input only - define the size of the array from your source document.  

* If this param is Not provided -  
  the size will be determined by the first document indexed and will apply to all subsequent documents.

* Ensure the dimensionality of these numerical arrays (i.e., their length) is consistent across all source documents for the indexed field.
  An index error will occur if a source document has a different dimension for the indexed field.

**Number of edges** -  
Specify the number of edges that will be created for a vector during indexing.  
If not specified, the default value is taken from the following configuration key: [Indexing.Corax.VectorSearch.DefaultNumberOfEdges](../server/configuration/indexing-configuration#indexing.corax.vectorsearch.defaultnumberofedges).

**Number of candidates for indexing time** -   
The  number of candidates (potential neighboring vectors) that RavenDB evaluates during vector indexing.  
If not specified, the default value is taken from the following configuration key: [Indexing.Corax.VectorSearch.DefaultNumberOfCandidatesForIndexing](../server/configuration/indexing-configuration#indexing.corax.vectorsearch.defaultnumberofcandidatesforindexing).   
(Note, this param differs from the number of candidates for query time).

{CONTENT-FRAME/}
{CONTENT-FRAME: }

#### Behavior during indexing
---

* For TEXTUAL input -  
  Embedding vectors are generated by the built-in [bge-micro-v2](https://huggingface.co/TaylorAI/bge-micro-v2) sentence-transformer model.

* For NUMERICAL input -  
  When indexing pre-made numerical arrays that are already in vector format,  
  RavenDB indexes them without transformation, unless further quantization is applied.

The embeddings are indexed on the server using the [HNSW algorithm](https://en.wikipedia.org/wiki/Hierarchical_navigable_small_world).  
This algorithm organizes embeddings into a high-dimensional graph structure,  
enabling efficient retrieval of Approximate Nearest Neighbors (ANN) during queries.

{CONTENT-FRAME/}
{CONTENT-FRAME: }

#### Parameters used at query time
---

**Minimum similarity** -  
You can specify the minimum similarity to use when searching for related vectors. Can be a value between `0.0f` and `1.0f`.  
A value closer to `1.0f` requires higher similarity between vectors, while a value closer to `0.0f` allows for less similarity.  
If not specified, the default value is taken from the following configuration key: [Indexing.Corax.VectorSearch.DefaultMinimumSimilarity](../server/configuration/indexing-configuration#indexing.corax.vectorsearch.defaultminimumsimilarity).

**Number of candidates at query time** -  
You can specify the maximum number of vectors that RavenDB will return from a graph search.  
The number of the resulting documents that correspond to these vectors may be:  

  * lower than the number of candidates - when multiple vectors originated from the same document.  
   
  * higher than the number of candidates - when the same vector is shared between multiple documents.

If not specified, the default value is taken from the following configuration key: [Indexing.Corax.VectorSearch.DefaultNumberOfCandidatesForQuerying](../server/configuration/indexing-configuration#indexing.corax.vectorsearch.defaultnumberofcandidatesforquerying).

**Search method** -  
You can specify the search method at query time:  

  *  _Approximate Nearest-Neighbor search_ (Default):  
     Search for related vectors in an approximate manner, providing faster results.

  *  _Exact search_:  
     Perform a thorough scan of the vectors to find the actual closest vectors,  
     offering better accuracy but at a higher computational cost.

---

**To ensure consistent comparisons** -  
the search term is transformed into an embedding vector using the same method as the vector index-field.  

**Search results** -  
The server will search for the most similar vectors in the indexed vector space, taking into account all the parameters described.
The documents that correspond to the resulting vectors are then returned to the client.

By default, the resulting documents will be ordered by their score.
You can modify this behavior using the [Indexing.Corax.VectorSearch.OrderByScoreAutomatically](../server/configuration/indexing-configuration#indexing.corax.vectorsearch.orderbyscoreautomatically) configuration key.  
In addition, you can apply any of the 'order by' methods to your query, as explained in [sort query results](../client-api/session/querying/sort-query-results).

{CONTENT-FRAME/}
{CONTENT-FRAME: }

#### Vector behavior when documents are deleted  
---

* RavenDB's implementation of the HNSW graph is append-only.  

* When all documents associated with a specific vector are deleted, the vector itself is Not physically removed but is soft-deleted.
  This means the vector is marked as deleted and will no longer appear in query results.  
  Currently, compaction is not supported.

{CONTENT-FRAME/}
{PANEL/}

{PANEL: Indexing vector data - TEXT}
 
The following index defines a **vector field** named `VectorfromText`.  
It indexes embeddings generated from the textual data in the `Name` field of all _Product_ documents.

{CODE-TABS}
{CODE-TAB:csharp:Map_index index_1@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:JS_index index_2@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:IndexDefinition index_3@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TABS/}

---

Execute a vector search using the index:  
Results will include _Product_ documents where the `Name` field is similar to the search term `"italian food"`.

{CODE-TABS}
{CODE-TAB:csharp:Query query_1@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:Query_async query_1_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery query_2@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery_async query_2_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery query_3@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery_async query_3_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB-BLOCK:sql:RQL}
from index "Products/ByVector/Text"
where vector.search(VectorFromText, "italian food", 0.82, 20)
{CODE-TAB-BLOCK/}
{CODE-TABS/}

{PANEL/}

{PANEL: Indexing vector data - NUMERICAL}

{NOTE: }
The examples in this section use the [sample data provided in the dynamic query article](../ai-integration/vector-search-using-dynamic-query#sample-data).
{NOTE/}

---

The following index defines a vector field named `VectorFromSingle `.  
It indexes embeddings generated from the numerical data in the `TagsEmbeddedAsSingle` field of all _Movie_ documents.
The raw numerical data in the source documents is in **32-bit floating-point format**.

{CODE-TABS}
{CODE-TAB:csharp:Map_index index_4@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:JS_index index_5@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:IndexDefinition index_6@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TABS/}

Execute a vector search using the index:

{CODE-TABS}
{CODE-TAB:csharp:Query query_4@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:Query_async query_4_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery query_5@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery_async query_5_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery query_6@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery_async query_6_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB-BLOCK:sql:RQL}
from index "Movies/ByVector/Single"
where vector.search(VectorFromSingle, $p0)
{ "p0" : { "@vector" : [6.599999904632568, 7.699999809265137] }}
{CODE-TAB-BLOCK/}
{CODE-TABS/}

---

The following index defines a vector field named `VectorFromInt8Arrays`.  
It indexes embeddings generated from the numerical arrays in the `TagsEmbeddedAsInt8` field of all _Movie_ documents.
The raw numerical data in the source documents is in **Int8 (8-bit integers) format**. 

{CODE-TABS}
{CODE-TAB:csharp:Map_index index_7@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:JS_index index_8@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:IndexDefinition index_9@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TABS/}

Execute a vector search using the index:

{CODE-TABS}
{CODE-TAB:csharp:Query query_7@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:Query_async query_7_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery query_8@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery_async query_8_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery query_9@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery_async query_9_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB-BLOCK:sql:RQL}
from index "Movies/ByVector/Int8"
where vector.search(VectorFromInt8Arrays, $p0)
{ "p0" : [64, 127, -51, -52, 76, 62] }
{CODE-TAB-BLOCK/}
{CODE-TABS/}

{PANEL/}

{PANEL: Indexing multiple field types}

An index can define multiple types of index-fields. In this example, the index includes:  
A _'regular'_ field, a _'vector'_ field, and a field configured for [full-text search](../indexes/querying/searching).  
This allows you to query across all fields using various predicates.

{CODE-TABS}
{CODE-TAB:csharp:Map_index index_10@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:JS_index index_11@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:IndexDefinition index_12@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TABS/}

Execute a query that combines predicates (using `OR`) across all index-field types:  

{CODE-TABS}
{CODE-TAB:csharp:DocumentQuery query_10@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:DocumentQuery_async query_10_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery query_11@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB:csharp:RawQuery_async query_11_async@AiIntegration\VectorSearchUsingStaticIndex.cs /}
{CODE-TAB-BLOCK:sql:RQL}
from index "Products/ByMultipleFields"
where PricePerUnit > $p0
or search(Name, $p1)
or vector.search(VectorFromText, $p2, 0.8)
{ "p0" : 200, "p1" : "Alice", "p2": "italian" }
{CODE-TAB-BLOCK/}
{CODE-TABS/}

{PANEL/}

{PANEL: Define a vector field in the Studio}

  ![Add vector field](images/add-vector-field-1.png "Add vector field")

  ![Customize vector field](images/add-vector-field-2.png "Customize vector field")

1. Click "Configure Vector Field"
2. Enter the vector field name
3. Customize the vector field's properties as needed.

{PANEL/}

{PANEL: Syntax}

{PANEL/}

## Related Articles

### Vector Search

- [RavenDB as a vector database](../ai-integration/ravendb-as-vector-database)
- [Vector search using a dynamic query](../ai-integration/vector-search-using-dynamic-query)
- [Data types for vector search](../ai-integration/data-tuypes-for-vector-search)

### Querying

- [Query overview](../client-api/session/querying/how-to-query)
- [Full-text search](../client-api/session/querying/text-search/full-text-search)
