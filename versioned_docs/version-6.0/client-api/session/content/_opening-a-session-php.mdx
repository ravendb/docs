import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<Admonition type="note" title="">

* A Session object is obtained from the [Document Store](../../../client-api/what-is-a-document-store.mdx).  

* Open a session using `openSession()`.  

* Various Session options can be configured using the `sessionOptions` object.  
  If no database is specified in the options then the [Default Database](../../../client-api/setting-up-default-database.mdx) (stored in the Document Store) is assumed.

* Make sure you release allocated session resources using the `close` method or wrapping 
  the session object in a `try` statement ([see below](../../../client-api/session/opening-a-session.mdx#example-3---releasing-session-resources)).  

* In this page:  
  * [Syntax](../../../client-api/session/opening-a-session.mdx#syntax)  
  * [Session options](../../../client-api/session/opening-a-session.mdx#session-options)  
  * [Open session examples](../../../client-api/session/opening-a-session.mdx#open-session-examples)
</Admonition>
## Syntax

* Use `openSession()` to open a session from the Document Store.  
* The following overloads are available:  

<TabItem value="open_session_1" label="open_session_1">
<CodeBlock language="php">
{`// Open session for a 'default' database configured in 'DocumentStore'
public function openSession(): DocumentSessionInterface;

// Open session for a specified database
public function openSession(string $database): DocumentSessionInterface;

public function openSession(SessionOptions $sessionOptions): DocumentSessionInterface;
`}
</CodeBlock>
</TabItem>

| Parameter    | Type             | Description                                                                                                                    |
|--------------|------------------|--------------------------------------------------------------------------------------------------------------------------------|
| **database** | `string`         | The Session will operate on this database,<br/>overriding the default database set in the document store.                       |
| **options**  | `sessionOptions` | An object with Session configuration options. See details [below](../../../client-api/session/opening-a-session.mdx#session-options). |

| Return Value               | Description                |
|----------------------------|----------------------------|
| `DocumentSessionInterface` | Document session interface |



## Session options

* The `sessionOptions` object contains various options to configure the Session's behavior.

| Option                | Type              | Description                                                                                                                                                                                                                               | Default Value                                         |
|-----------------------|-------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
| **Database**          | `string`          | The Session will operate on this database,<br/>overriding the Default Database.                                                                                                                                                            | `null` - the Session operates on the Default Database |
| **NoTracking**        | `bool`            | `true` - The Session tracks changes made to all entities it loaded, stored, or queried for.<br/>`false` - Tracking will be turned off.<br/>Learn more in [Disable tracking](../../../client-api/session/configuration/how-to-disable-tracking.mdx) | `false`                                               |
| **NoCaching**         | `bool`            | `true` - Server responses will Not be cached.<br/>`false` - The Session caches the server responses.<br/>Learn more in [Disable caching](../../../client-api/session/configuration/how-to-disable-caching.mdx)                                     | `false`                                               |
| **RequestExecutor**   | `RequestExecutor` | ( _Advanced option_ ) <br/>The request executor the Session should use.                                                                                                                                                                    | `null` - the default request executor is used         |
| **TransactionMode**   | `TransactionMode` | Specify the Session's transaction mode<br/>`SingleNode` / `ClusterWide`<br/>Learn more in [Cluster-wide vs. Single-node](../../../client-api/session/cluster-transaction/overview.mdx#cluster-wide-transaction-vs-single-node-transaction)        | `SingleNode`                                          |

* Experts Only:

| Option                                                       | Type                | Description                                                                                                                                                                                                                                             | Default Value |
|--------------------------------------------------------------|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| **DisableAtomicDocumentWrites-<br/>InClusterWideTransaction** | `bool?`               | ( _Experts only_ ) <br/>`true` - Disable Atomic-Guards in cluster-wide sessions.<br/>`false` - Automatic atomic writes in cluster-wide sessions are enabled.<br/>Learn more in [Atomic-Guards](../../../client-api/session/cluster-transaction/atomic-guards.mdx) | `false`       |



## Open session examples

#### Example 1
<TabItem value="open_session_2" label="open_session_2">
<CodeBlock language="php">
{`$store->openSession(new SessionOptions());
`}
</CodeBlock>
</TabItem>

#### Example 2
<TabItem value="open_session_3" label="open_session_3">
<CodeBlock language="php">
{`$sessionOptions = new SessionOptions();
$sessionOptions->setDatabase($databaseName);
$store->openSession($sessionOptions);
`}
</CodeBlock>
</TabItem>

#### Example 3 - Releasing session resources
<Admonition type="note" title="">
Always remember to release allocated session resources after usage by 
invoking the `close` method or wrapping the session object in a `try` statement.
</Admonition>
<TabItem value="open_session_4" label="open_session_4">
<CodeBlock language="php">
{`$session = $store->openSession();
try \{
    // code here
\} finally \{
    $session->close();
\}
`}
</CodeBlock>
</TabItem>

#### Example 4 - Disable entities tracking
<TabItem value="open_session_no_tracking" label="open_session_no_tracking">
<CodeBlock language="php">
{`$sessionOptions = new SessionOptions();
$sessionOptions->setNoTracking(true);
$session = $store->openSession();
try \{
    $employee1 = $session->load(Employee::class, "employees/1-A");
    $employee2 = $session->load(Employee::class, "employees/1-A");

    // because NoTracking is set to 'true'
    // each load will create a new Employee instance
    $this->assertNotSame($employee1, $employee2);
\} finally \{
    $session->close();
\}
`}
</CodeBlock>
</TabItem>

#### Example 5 - Disable session caching
<TabItem value="open_session_no_caching" label="open_session_no_caching">
<CodeBlock language="php">
{`$sessionOptions = new SessionOptions();
$sessionOptions->setNoCaching(true);
$session = $store->openSession();
try \{
    // code here
\} finally \{
    $session->close();
\}
`}
</CodeBlock>
</TabItem>




