import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import ContentFrame from '@site/src/components/ContentFrame';
import Panel from '@site/src/components/Panel';

<Admonition type="note" title="">

* By default, data archiving is disabled.  
  To use the archiving feature, you must first **enable** it.
 
* When configuring the feature,  
  you can also set the **frequency** at which RavenDB scans the database for documents scheduled for archiving.

* Once enabled, the archiving task runs periodically at the configured frequency,  
  scanning the database for documents that have been scheduled for archival.  
  Learn how to schedule documents for archival in [Schedule document archiving](../../data-archival/schedule-document-archiving.mdx).

* In this article:
  * [Enable archiving - from the Client API](../../data-archival/enable-data-archiving.mdx#enable-archiving-from-the-client-api)
  * [Enable archiving - from the Studio](../../data-archival/enable-data-archiving.mdx#enable-archiving-from-the-studio)  

</Admonition>

<Panel heading="Enable archiving - from the Client API">
 
Use `ConfigureDataArchivalOperation` to enable archiving for the database and configure the archiving task.
    
**Example**:

<Tabs groupId='languageSyntax'>
<TabItem value="Enable_archiving" label="Enable_archiving">
```csharp
// Define the archival configuration object
var configuration = new DataArchivalConfiguration
{
    // Enable archiving
    Disabled = false,

    // Optional: override the default archiving frequency
    // Scan for documents scheduled for archiving every 180 seconds 
    ArchiveFrequencyInSec = 180,
    
    // Optional: limit the number of documents processed in each archival run
    MaxItemsToProcess = 100 
};

// Define the archival operation, pass the configuration 
var configureArchivalOp = new ConfigureDataArchivalOperation(configuration);
    
// Execute the operation by passing it to Maintenance.Send
store.Maintenance.Send(configureArchivalOp);
```
</TabItem>
<TabItem value="Enable_archiving_async" label="Enable_archiving_async">
```csharp
// Define the archival configuration object
var configuration = new DataArchivalConfiguration
{
    // Enable archiving
    Disabled = false,
    
    // Optional: override the default archiving frequency
    // Scan for documents scheduled for archiving every 180 seconds 
    ArchiveFrequencyInSec = 180,
    
    // Optional: limit the number of documents processed in each archival run
    MaxItemsToProcess = 100 
};

// Define the archival operation, pass the configuration 
var configureArchivalOp = new ConfigureDataArchivalOperation(configuration);
    
// Execute the operation by passing it to Maintenance.SendAsync
await store.Maintenance.SendAsync(configureArchivalOp);
```
</TabItem>
</Tabs>
    
**Syntax**:

<TabItem>
```csharp
public ConfigureDataArchivalOperation(DataArchivalConfiguration configuration)
```
</TabItem>

<TabItem>
```csharp
public class DataArchivalConfiguration
{
    public bool Disabled { get; set; }
    public long? ArchiveFrequencyInSec { get; set; }
    public long? MaxItemsToProcess { get; set; }
}
```
</TabItem>

| Parameter                 | Type    | Description                                                                                                                                                            |
|---------------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Disabled**              | `bool`  | `true` - archiving is disabled for the entire database (default).<br/>`false` - archiving is enabled for the database.                                                 |
| **ArchiveFrequencyInSec** | `long?` | Frequency (in seconds) at which the server scans for documents scheduled for archiving. Default: `60`                                                                  |
| **MaxItemsToProcess**     | `long?` | The maximum number of documents the archiving task will process in a single run (i.e., each time it is triggered by the configured frequency).<br/>Default: `int.MaxValue` |

</Panel>

<Panel heading="Enable archiving - from the Studio">

![Enable archiving](../assets/enable-archiving.png)

1. Go to **Settings &gt; Data Archival**.
2. Toggle on to enable data archival.
3. Toggle on to customize the frequency at which the server scans for documents scheduled for archiving.  
   Default is 60 seconds.
4. Toggle on to customize the maximum number of documents the archiving task will process in a single run.
5. Click Save to apply your settings.
    
</Panel>    