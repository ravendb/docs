import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<Admonition type="note" title="">

* Use `DeleteCompareExchangeValueOperation` to delete a compare-exchange item.  

* The compare-exchange item is only deleted if the _index_ in the request is __equal__ to the current _index_  
  stored on the server for the specified _key_.  

* Compare-exchange items can also be deleted via [advanced session methods](../../../../client-api/session/cluster-transaction/compare-exchange.mdx), 
  or from the [Studio](../../../../studio/database/documents/compare-exchange-view.mdx).

* In this page:  
  * [Delete compare exchange item](../../../../client-api/operations/compare-exchange/delete-compare-exchange-value.mdx#delete-compare-exchange-item)
  * [Syntax](../../../../client-api/operations/compare-exchange/delete-compare-exchange-value.mdx#syntax)  

</Admonition>
## Delete compare exchange item

<TabItem value="delete_1" label="delete_1">
<CodeBlock language="js">
{`// Get an existing compare-exchange item
const getCmpXchgOp = new GetCompareExchangeValueOperation("johnDoe@gmail.com");
const itemResult = await documentStore.operations.send(getCmpXchgOp);

// Keep the item's version
const versionOfItem = itemResult.index; 

// Delete the compare-exchange item:
// =================================

// Define the delete compare-exchange operation, pass:
// * The item's KEY
// * The item's INDEX (its version)
//   The compare-exchange item will only be deleted if this number 
//   is equal to the one stored on the server when the delete operation is executed.
const deleteCmpXchgOp = new DeleteCompareExchangeValueOperation("johnDoe@gmail.com", versionOfItem);

// Execute the operation by passing it to operations.send
const deleteResult = await documentStore.operations.send(deleteCmpXchgOp);

// Verify delete results:
assert.ok(deleteResult.successful);
`}
</CodeBlock>
</TabItem>



## Syntax

<TabItem value="syntax_1" label="syntax_1">
<CodeBlock language="js">
{`const deleteCmpXchgOp = new DeleteCompareExchangeValueOperation(key, index, clazz?);
`}
</CodeBlock>
</TabItem>

| Parameter   | Type   | Description                                                                  |
|-------------|--------|------------------------------------------------------------------------------|
| __key__     | string | The key of the item to be deleted                                            |
| __index__   | number | The version number of the item to be deleted                                 |
| __clazz__   | object | When the item's value is a class, you can specify its type in this parameter |

<TabItem value="syntax_2" label="syntax_2">
<CodeBlock language="js">
{`// Return value of store.operations.send(deleteCmpXchgOp)
// ======================================================
class CompareExchangeResult \{
    successful;
    value;
    index;
\}
`}
</CodeBlock>
</TabItem>

| Return Value   | Type    | Description                                                                                                                                                                                                                  |
|----------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| __successful__ | boolean | <ul><li>`true` if the delete operation was successfully completed.</li><li>`true` if _key_ doesn't exist.</li><li>`false` if the delete operation has failed, e.g. when the index version doesn't match.</li></ul>           |
| __value__      | object  | <ul><li>The value that was deleted upon a successful delete.</li><li>`null` if _key_ doesn't exist.</li><li>The currently existing _value_ on the server if the delete operation has failed.</li></ul>                       |
| __index__      | number  | <ul><li>The next available version number upon success.</li><li>The next available version number if _key_ doesn't exist.</li><li>The currently existing _index_ on the server if the delete operation has failed.</li></ul> |
